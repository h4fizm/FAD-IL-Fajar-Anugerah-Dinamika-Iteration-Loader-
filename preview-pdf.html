<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tes Generate PDF</title>
    <style>
      body {
        font-family: sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f4f4f4;
      }
      #generatePdfBtn {
        padding: 15px 30px;
        font-size: 18px;
        color: white;
        background-color: #007bff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
      }
      #generatePdfBtn:hover {
        background-color: #0056b3;
      }
    </style>
  </head>
  <body>
    <button id="generatePdfBtn">Buat Laporan PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <script>
      document
        .getElementById("generatePdfBtn")
        .addEventListener("click", function () {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          // --- HEADER ---
          doc.setFontSize(10);
          doc.setTextColor(100);
          doc.text(
            "PT Fajar Anugerah Dinamika",
            doc.internal.pageSize.getWidth() / 2,
            15,
            { align: "center" }
          );
          doc.setFontSize(22);
          doc.setFont("helvetica", "bold");
          doc.setTextColor(40);
          doc.text(
            "Hasil Laporan Akhir",
            doc.internal.pageSize.getWidth() / 2,
            25,
            { align: "center" }
          );
          doc.setFontSize(12);
          doc.setFont("helvetica", "normal");
          doc.text(
            "Senin, 01 September 2025",
            doc.internal.pageSize.getWidth() / 2,
            32,
            { align: "center" }
          );

          // --- DATA ---
          const generalInfo = [
            ["Nama Unit", "FEX 1208"],
            ["Jenis Material", "Blasting (OB)"],
            ["Nama Operator", "RUDI"],
            ["Observer", "FAREL"],
            ["Jumlah Sesi Loader", "1 Kali"],
          ];

          const loaderAnalysis = [
            ["Rata-rata Jumlah Passing", "1 passing"],
            ["Rata-rata Digging Time", "7.32 detik"],
            ["Rata-rata Swing Load", "6.59 detik"],
            ["Rata-rata Bucket Dump", "6.42 detik"],
            ["Rata-rata Swing Empty", "6.96 detik"],
            ["Rata-rata Spotting Time", "7.93 detik"],
            ["Rata-rata Cycle Time Loader", "35.22 detik"],
            ["Rata-rata Loading Time", "0.59 menit"],
          ];

          const haulerAnalysis = [
            ["Jarak Dumping", "1000 meter"],
            ["Jumlah Hauler", "10 Unit"],
            ["Rata-rata Cycle Time Hauler", "0.14 menit"],
            ["Rata-rata Kecepatan Hauler", "848.05 km/jam"],
            ["Matching Fleet", "32.79"],
            ["Proyeksi Produktivitas", "129 Ritase/Jam"],
          ];

          const problemAnalysis = [
            ["Man", "Nihil"],
            ["Machine", "UI: Boom Loader Low Power"],
            ["Material", "Nihil"],
            ["Method", "Nihil"],
            ["Environment", "Nihil"],
            ["Remarks Tambahan", "-"],
          ];

          const tableOptions = {
            theme: "grid",
            styles: { fontSize: 10, cellPadding: 2.5 },
            headStyles: {
              fillColor: [240, 240, 240],
              textColor: 40,
              fontStyle: "bold",
              halign: "center",
            },
            columnStyles: {
              0: { fontStyle: "bold", fillColor: [250, 250, 250] },
            },
            didParseCell: function (hookData) {
              const boldRows = [
                "Rata-rata Cycle Time Loader",
                "Rata-rata Loading Time",
                "Matching Fleet",
                "Proyeksi Produktivitas",
              ];
              if (boldRows.includes(hookData.cell.raw)) {
                hookData.cell.styles.fontStyle = "bold";
              }
            },
            margin: { left: 14, right: 14 },
          };

          // --- TABEL (head harus sesuai dengan body: 2 kolom) ---
          doc.autoTable({
            startY: 45,
            head: [["Informasi Umum", ""]],
            body: generalInfo,
            ...tableOptions,
          });
          doc.autoTable({
            head: [["Analisis Loader", ""]],
            body: loaderAnalysis,
            ...tableOptions,
          });
          doc.autoTable({
            head: [["Analisis Hauler & Produktivitas", ""]],
            body: haulerAnalysis,
            ...tableOptions,
          });
          doc.autoTable({
            head: [["Analisa Problem Produktivitas", ""]],
            body: problemAnalysis,
            ...tableOptions,
          });

          // --- SIMPAN PDF ---
          doc.save(`Laporan_Akhir_FAD_01092025.pdf`);
        });
    </script>
  </body>
</html>
